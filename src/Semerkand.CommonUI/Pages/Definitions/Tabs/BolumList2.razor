@inject HttpClient Http;
@using Semerkand.Shared.Dto.Definitions
@inject IMatToaster matToaster
@using Syncfusion.Blazor.DropDowns
@using System.Net
@using Newtonsoft.Json
@using Semerkand.Shared.DataModels
@using Syncfusion.Blazor
@using Syncfusion.Blazor.Data

<ControlSection>
    <SfGrid TValue="Bolum" AllowPaging="true" AllowFiltering="true">
        <SfDataManager Url="api/bolum/GetAllQueryble" Adaptor="Adaptors.WebApiAdaptor"></SfDataManager>
        <GridPageSettings PageSize="5"></GridPageSettings>
        <GridColumns>
            <GridColumn Visible="false" Field=@nameof(Bolum.Id) HeaderText="Bölüm ID" Edit="false" AllowEditing="false" IsPrimaryKey="true" TextAlign="TextAlign.Left" Width="140"></GridColumn>
            <GridColumn Field=@nameof(Bolum.Ad) HeaderText="Bölüm İsim"></GridColumn>
            <GridColumn Field=@nameof(Bolum.KisaAd) HeaderText="KisaAd"></GridColumn>
            <GridColumn Field=@nameof(Bolum.Kod) HeaderText="Kod"></GridColumn>
            <GridColumn Field=@nameof(Bolum.AdEn) HeaderText="AdEn"></GridColumn>
            <GridColumn Field=@nameof(Bolum.OsymKod) HeaderText="OsymKod"></GridColumn>
            @*<GridColumn Field=@nameof(Bolum.OgrenimTurId) HeaderText="Ogrenim Tür" ForeignKeyValue="Ad" ForeignKeyField="Id" DataSource="@ogrenimTurDtos"></GridColumn>
            <GridColumn Field=@nameof(Bolum.FakulteId) HeaderText="Fakülte" ForeignKeyValue="Ad" ForeignKeyField="Id" DataSource="@fakulteDtos"></GridColumn>*@
            <GridColumn Field=@nameof(Bolum.OgrenimSure) HeaderText="OgrenimSure"></GridColumn>
            <GridColumn Field=@nameof(Bolum.Durum) EditType="EditType.BooleanEdit" HeaderText="Durum"></GridColumn>
            <GridColumn Field=@nameof(Bolum.DiplomaAd) HeaderText="DiplomaAd"></GridColumn>
            <GridColumn Field=@nameof(Bolum.IsBologna) EditType="EditType.BooleanEdit" HeaderText="IsBologna"></GridColumn>
            <GridColumn Field=@nameof(Bolum.DiplomaAdEn) HeaderText="DiplomaAdEn"></GridColumn>
        </GridColumns>
    </SfGrid>
</ControlSection>

@code{

    List<FakulteDto> fakulteDtos = new List<FakulteDto>();
    List<OgrenimTurDto> ogrenimTurDtos = new List<OgrenimTurDto>();

    protected override async Task OnInitializedAsync()
    {

        ApiResponseDto apiResponse = await Http.GetFromJsonAsync<ApiResponseDto>("api/fakulte");
        fakulteDtos = Newtonsoft.Json.JsonConvert.DeserializeObject<FakulteDto[]>(apiResponse.Result.ToString()).ToList<FakulteDto>();
        ApiResponseDto apiResponseOgrTur = await Http.GetFromJsonAsync<ApiResponseDto>("api/ogrenimtur");
        ogrenimTurDtos = Newtonsoft.Json.JsonConvert.DeserializeObject<OgrenimTurDto[]>(apiResponseOgrTur.Result.ToString()).ToList<OgrenimTurDto>();

    }



}
